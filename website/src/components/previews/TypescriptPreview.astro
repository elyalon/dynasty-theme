<pre>
<span class="TOKEN_keyword">export</span> <span class="TOKEN_keyword">type</span> <span class="TOKEN_type">Todo</span> <span class="TOKEN_operator">=</span> <span class="TOKEN_punctuation">{'{'}</span>
  id<span class="TOKEN_operator">:</span> <span class="TOKEN_type">string</span><span class="TOKEN_punctuation">;</span>
  text<span class="TOKEN_operator">:</span> <span class="TOKEN_type">string</span><span class="TOKEN_punctuation">;</span>
  completed<span class="TOKEN_operator">:</span> <span class="TOKEN_type">boolean</span><span class="TOKEN_punctuation">;</span>
<span class="TOKEN_punctuation">{'}'}</span>

<span class="TOKEN_keyword">export class</span> <span class="TOKEN_type">TodoService</span> <span class="TOKEN_punctuation">{'{'}</span>
  <span class="TOKEN_keyword">async</span> <span class="TOKEN_function">get</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_punctuation">)</span><span class="TOKEN_operator">:</span> <span class="TOKEN_type">Promise</span><span class="TOKEN_punctuation">&lt;</span><span class="TOKEN_type">Todo</span><span class="TOKEN_punctuation">[]</span><span class="TOKEN_punctuation">&gt;</span> <span class="TOKEN_punctuation">{'{'}</span>
    <span class="TOKEN_keyword">const</span> todos <span class="TOKEN_operator">=</span> <span class="TOKEN_keyword">await</span> <span class="TOKEN_keyword">this</span><span class="TOKEN_punctuation">.</span>env<span class="TOKEN_punctuation">.</span>TODOS<span class="TOKEN_punctuation">.</span><span class="TOKEN_function">get</span><span class="TOKEN_punctuation">&lt;</span><span class="TOKEN_type">Todo</span><span class="TOKEN_punctuation">[]</span><span class="TOKEN_punctuation">&gt;</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_keyword">this</span><span class="TOKEN_punctuation">.</span>userID<span class="TOKEN_punctuation">,</span> <span class="TOKEN_string">"json"</span><span class="TOKEN_punctuation">)</span>
    <span class="TOKEN_keyword">return</span> todos <span class="TOKEN_operator">||</span> <span class="TOKEN_punctuation">[]</span><span class="TOKEN_punctuation">;</span>
  <span class="TOKEN_punctuation">{'}'}</span>

  <span class="TOKEN_keyword">async</span> <span class="TOKEN_function">set</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_parameter">todos</span><span class="TOKEN_operator">:</span> <span class="TOKEN_type">Todo</span><span class="TOKEN_punctuation">[])</span><span class="TOKEN_operator">:</span> <span class="TOKEN_type">Promise</span><span class="TOKEN_punctuation">&lt;</span><span class="TOKEN_type">Todo</span><span class="TOKEN_punctuation">[]</span><span class="TOKEN_punctuation">&gt;</span> <span class="TOKEN_punctuation">{'{'}</span>
    <span class="TOKEN_keyword">const</span> sorted <span class="TOKEN_operator">=</span> <span class="TOKEN_parameter">todos</span><span class="TOKEN_punctuation">.</span><span class="TOKEN_function">sort</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_parameter">t1</span><span class="TOKEN_punctuation">,</span> <span class="TOKEN_parameter">t2</span><span class="TOKEN_punctuation">)</span> <span class="TOKEN_keyword">=&gt;</span> <span class="TOKEN_punctuation">{'{'}</span>
      <span class="TOKEN_keyword">if</span> <span class="TOKEN_punctuation">(</span><span class="TOKEN_parameter">t1</span><span class="TOKEN_punctuation">.</span>completed <span class="TOKEN_operator">===</span> <span class="TOKEN_parameter">t2</span><span class="TOKEN_punctuation">.</span>completed<span class="TOKEN_punctuation">)</span> <span class="TOKEN_punctuation">{'{'}</span>
        <span class="TOKEN_keyword">return</span> <span class="TOKEN_parameter">t1</span><span class="TOKEN_punctuation">.</span>id<span class="TOKEN_punctuation">.</span><span class="TOKEN_function">localeCompare</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_parameter">t2</span><span class="TOKEN_punctuation">.</span>id<span class="TOKEN_punctuation">)</span><span class="TOKEN_punctuation">;</span>
      <span class="TOKEN_punctuation">{'}'}</span>
      <span class="TOKEN_keyword">return</span> <span class="TOKEN_parameter">t1</span><span class="TOKEN_punctuation">.</span>completed <span class="TOKEN_operator">?</span> <span class="TOKEN_number">1</span> <span class="TOKEN_operator">:</span> <span class="TOKEN_operator">-</span><span class="TOKEN_number">1</span><span class="TOKEN_punctuation">;</span>
    <span class="TOKEN_punctuation">{'}'});</span>

    <span class="TOKEN_keyword">await</span> <span class="TOKEN_keyword">this</span><span class="TOKEN_punctuation">.</span>env<span class="TOKEN_punctuation">.</span>TODOS<span class="TOKEN_punctuation">.</span><span class="TOKEN_function">put</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_keyword">this</span><span class="TOKEN_punctuation">.</span>userID<span class="TOKEN_punctuation">,</span> JSON<span class="TOKEN_punctuation">.</span><span class="TOKEN_function">stringify</span><span class="TOKEN_punctuation">(</span>sorted<span class="TOKEN_punctuation">)</span><span class="TOKEN_punctuation">)</span>
    <span class="TOKEN_keyword">return</span> sorted
  <span class="TOKEN_punctuation">{'}'}</span>

  <span class="TOKEN_keyword">async</span> <span class="TOKEN_function">add</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_parameter">todoText</span><span class="TOKEN_operator">:</span> <span class="TOKEN_type">string</span><span class="TOKEN_punctuation">)</span><span class="TOKEN_operator">:</span> <span class="TOKEN_type">Promise</span><span class="TOKEN_punctuation">&lt;</span><span class="TOKEN_type">Todo</span><span class="TOKEN_punctuation">[]</span><span class="TOKEN_punctuation">&gt;</span> <span class="TOKEN_punctuation">{'{'}</span>
    <span class="TOKEN_keyword">const</span> todos <span class="TOKEN_operator">=</span> <span class="TOKEN_keyword">await</span> <span class="TOKEN_keyword">this</span><span class="TOKEN_punctuation">.</span><span class="TOKEN_function">get</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_punctuation">)</span>
    <span class="TOKEN_keyword">const</span> newTodo<span class="TOKEN_operator">:</span> <span class="TOKEN_type">Todo</span> <span class="TOKEN_operator">=</span> <span class="TOKEN_punctuation">{'{'}</span>
      id<span class="TOKEN_punctuation">:</span> <span class="TOKEN_type">Date</span><span class="TOKEN_punctuation">.</span><span class="TOKEN_function">now</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_punctuation">)</span><span class="TOKEN_punctuation">.</span><span class="TOKEN_function">toString</span><span class="TOKEN_punctuation">(</span><span class="TOKEN_punctuation">)</span><span class="TOKEN_punctuation">,</span>
      text<span class="TOKEN_punctuation">:</span> <span class="TOKEN_parameter">todoText</span><span class="TOKEN_punctuation">,</span>
      completed<span class="TOKEN_punctuation">:</span> <span class="TOKEN_keyword">false</span>
    <span class="TOKEN_punctuation">{'}'};</span>
    todos<span class="TOKEN_punctuation">.</span><span class="TOKEN_function">push</span><span class="TOKEN_punctuation">(</span>newTodo<span class="TOKEN_punctuation">)</span>
    <span class="TOKEN_keyword">return</span> <span class="TOKEN_keyword">this</span><span class="TOKEN_punctuation">.</span><span class="TOKEN_function">set</span><span class="TOKEN_punctuation">(</span>todos<span class="TOKEN_punctuation">)</span>
  <span class="TOKEN_punctuation">{'}'}</span>
<span class="TOKEN_punctuation">{'}'}</span>
</pre>
